//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "UDictionaryMed.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "DBAxisGridsEh"
#pragma link "DBGridEh"
#pragma link "DBGridEhGrouping"
#pragma link "DBGridEhToolCtrls"
#pragma link "DynVarsEh"
#pragma link "GridsEh"
#pragma link "ToolCtrlsEh"
#pragma resource "*.dfm"
TFDictionaryMed *FDictionaryMed;
//---------------------------------------------------------------------------
__fastcall TFDictionaryMed::TFDictionaryMed(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::setView(){
	BAdd->Enabled = false;
	BEdit->Enabled = false;
	BDelete->Enabled = false;

	EOtch->Color = clWhite;
	EName->Color = clWhite;
	ESurname->Color = clWhite;
	ELogin->Color = clWhite;
	EPassword->Color = clWhite;
	DBLookupComboBoxOffice->Color = clWhite;

	EOtch->Enabled = true;
	EName->Enabled = true;
	ESurname->Enabled = true;
	ELogin->Enabled = true;
	EPassword->Enabled = true;
	DBLookupComboBoxOffice->Enabled = true;
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::ESurnameExit(TObject *Sender)
{
	ESurname->Text = ESurname->Text.UpperCase();
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::ENameExit(TObject *Sender)
{
	EName->Text = EName->Text.UpperCase();
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::EOtchExit(TObject *Sender)
{
	EOtch->Text = EOtch->Text.UpperCase();
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::FormShow(TObject *Sender)
{
	if(DMAvtoriz->DSAvtoriz->DataSet->FieldByName("login")->AsAnsiString != "admin"){
		DMAvtoriz->SQLQCatalogMed->Close();
		DMAvtoriz->SQLQCatalogMed->SQL->Text = "SELECT `surname`,`name`,`patronymic`,`login`,`name_office` "
			"FROM `user` INNER JOIN `office` ON `user`.`id_office` = `office`.`id_office` "
			"WHERE `user`.`id_user` != 1";
	}
	DMAvtoriz->SQLQCatalogMed->Open();
	DMAvtoriz->CDSCatalogMed->Close();
	DMAvtoriz->CDSCatalogMed->Open();
}
//---------------------------------------------------------------------------
void __fastcall TFDictionaryMed::FormClose(TObject *Sender, TCloseAction &Action)
{
	DMAvtoriz->SQLQCatalogMed->Close();
	DMAvtoriz->CDSCatalogMed->Close();
	BCancelClick(Sender);
}
//---------------------------------------------------------------------------

void __fastcall TFDictionaryMed::BAddClick(TObject *Sender)
{
	setView();
}
//---------------------------------------------------------------------------

void __fastcall TFDictionaryMed::BEditClick(TObject *Sender)
{
	setView();
}
//---------------------------------------------------------------------------

void __fastcall TFDictionaryMed::BCancelClick(TObject *Sender)
{
	BAdd->Enabled = true;
	BEdit->Enabled = true;
	BDelete->Enabled = true;

	EOtch->Color = clBtnFace;
	EName->Color = clBtnFace;
	ESurname->Color = clBtnFace;
	ELogin->Color = clBtnFace;
	EPassword->Color = clBtnFace;
	DBLookupComboBoxOffice->Color = clBtnFace;

	EOtch->Text = "";
	EName->Text = "";
	ESurname->Text = "";
	ELogin->Text = "";
	EPassword->Text = "";

	EOtch->Enabled = false;
	EName->Enabled = false;
	ESurname->Enabled = false;
	ELogin->Enabled = false;
	EPassword->Enabled = false;
	DBLookupComboBoxOffice->Enabled = false;
}
//---------------------------------------------------------------------------


